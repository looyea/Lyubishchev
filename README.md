# 1. 整体设计

全都重新做了设计，依照与完全配置化的内容进行的处理的思路。也就是说完全依赖配置类完成具体的工作了。 

## 1.1 整体流程

整体加载流程如下：

1. 加载ActiveProfiles
2. 根据激活列表名字，加载每个区块的任务
3. 根据每个区块任务，加载具体区块配置
4. 根据具体的区块配置，生成具体的任务类
5. 根据任务类的调用链，依次完成任务需求

## 1.2 Active Profiles

最开头是激活Profile配置，配置的是当前激活的profile是那些。

被激活的Profiles里面列出来ini的每个区段名字[SectorName]，注意不包括方括号。名字要求：

- 大小写敏感
- 可以有多个
- 多个名字用英文逗号分割

注意，Sector Name一定是要出现在配置文件中的。如果没有的话，会因为找不到而跳过。

## 1.3 区块配置

每个区块配置都包含了一套完整的实现流程。

我们建议，将每套区块实现流程，放到同名的文件夹下，方便管理。然后根据不同的配置内容，对应不同的类，去实现具体的实现步骤。 

总体上，区块的配置包括的主要内容：

1. 区块任务名
2. 区块任务说明
3. 区块任务配置类处理链
    1. 调用链：区块任务实现类
    2. 图表链：具体的图形工具
    3. 输出类：需要输出文档的，给出输出内容
4. 其他配置

任务名：说明白这个区块的名字

任务说明：说明白这个任务是干啥的

配置类：具体的配置内容。它会蕴含调用链、图表链、输出链。调用链，用来实现任务数据批量处理内容。图表链，用来配置批量处理的图表的处理类内容。输出链，如果需要输出，则配置了。例如输出成HTML，或者Markdown。

其他配置：相关的配置内容。或者说是调用、图表、输出的绑定。

#  2. 区块实现

考虑的就是：

1. 加载配置
2. 任务处理链
    1. 数据处理
    2. 图表绘制
    3. 数据输出

这样的流程进行处理。

## 2.1 加载配置

每个区块需要一个基本的配置加载类。这个配置加载类，内部包括的属性都对应着区块配置内容。

此外配置加载还负责加载数据的最原始内容。

## 2.2 任务处理链

每个任务处理链都是在配置区块中配置的不同的任务。

每个链，作为一个单独的配置项。每个配置项至多有3个用英文逗号分割的数组，其中的值分别对应了数据处理、图表绘制、数据输出。

这样做的目的就是限定处理的内容和目标，尽量保持任务的简单程度。

### 2.2.1 数据处理

最初的数据处理基本包括的任务可能是：

- 输出处理的范围（时间、数量等等）
- 数据清洗（清洗无效数据）
- 数据转化，按照要求转化成一定业意义的数据，包括内容、格式的转化
- 输出前处理，在最终形成输出的时候，进行的一些后处理部分

这里一般都是转化成不同的DataFrame，但是可能不只有一个。此外还可能有多个控制变量。索性这些也可通过字典实现。但是建议都通过一个有效的DF完成最简单。

### 2.2.2 适配转换

此步骤是多加的， 如果目标图形输出，是不支持DF，或者只支持特定的类型，可以在这个步骤完成。其实这里的适配转换，完全可以在数据处理的输出部分完成。

### 2.2.3 图表绘制

根据实际情况绘制要展现的图表。图表绘制可能有多个，完全按照个人需要去完成就好了。

### 2.2.4 数据输出

根据需要，展示图形，或者输出成为必要的内容形式。这个都按照个人需求。例如输出成为Markdown或者HTML等等。再或者输出成一个报告。

当然，数据输出依赖于输入的数据不同，各种控制结构不同而定。完全看实际情况




-----------

以下是2020年的内容

# 主要程序文件介绍

## __main__.py
主程序入口，不过这个程序依然丑陋，以后会改的


## basecfg.py
负责配置的程序，会从configure.ini文件中读取配置信息，然后进行装配。实际使用的时候，请使用ctx这个上下文环境变量。

配置内容都在configure.ini中，目前功能相对比较简单，根据实际需求进行修改吧。


## global_static.py
## global_static_range.py
主要是负责统计、变换的类，根据实际需求，将需要统计的类，变幻出目标的Pivot table，然后交给相关的程序进行画图处理。
原本是想将这个类，也做画图处理，现在会分开进行。
带range结尾的，是用作连续月份统计，方便后续年分析的时候使用

## global_draw.py
## global_draw_range.py
主要负责画图，特别是，针对文字标签进行描述的部分
带range结尾的，是用作连续月份统计，方便后续年分析的时候使用

## README.md
现在阅读的本尊

## ReleaseNote.txt
未来版本考虑要更新的功能，但是不一定严格按照这方面进行。可能中途有了新的想法，然后进行处理的

## test.py

没有用的程序，是开发过程中验证技术使用的测试文件

# Resources目录文档介绍

## template 模板文件夹

这里模板文件夹，主要是为了存放输出、输入用的一些模板使用的。当前因为没有启动模板功能，所以相应的，这些模板都没有实际使用用途。

### 2020.md

当前2020年用的模板，暂时用不到。

## 2020时间日志.xlsx

当前使用的时间日志模板。实际使用的时候，需要填写里面的内容哈。不然就么有意义的。具体的使用，我会用一个使用说明书单独进行说明的。

## midwest_filter.csv

没用的文件，用来验证一些技术试验的时候使用。当前没有用处，可以不用理会。 

# testfiles目录介绍

此目录，全都是各种为了实现功能过程中进行的技术点、技术细节验证
